<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vionyx Venue Booking</title>

  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet" />

  <style>
    /* ‚Äî‚Äî‚Äî HEADER & NAV (exact from index.html) ‚Äî‚Äî‚Äî */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    header {
      width: 100%;
      position: absolute;
      top: 0; left: 0; z-index: 12;
      background: rgba(24,32,48,0.38);
      backdrop-filter: blur(6px) saturate(150%);
      -webkit-backdrop-filter: blur(6px) saturate(150%);
      box-shadow: 0 2px 10px rgba(0,0,0,0.17);
    }
    .logo-nav {
      max-width: 1200px;
      margin: 0 auto;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.5rem 2rem;
    }
    .logo-nav img {
      height: 60px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.10);
      background: #fff;
      padding: 2px;
    }
    nav ul {
      list-style: none;
      display: flex;
      gap: 2rem;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      padding: 0.5rem 0;
      position: relative;
      letter-spacing: 0.02em;
      transition: color 0.18s;
    }
    nav a:hover { color: #ffe165; }
    nav a::after {
      content: '';
      position: absolute; left: 0; bottom: -4px;
      width: 0; height: 2px;
      background: #ffdd57;
      transition: width 0.3s;
    }
    nav a:hover::after { width: 100%; }

    /* Mobile (‚â§900px): only Home + Contact Us */
    @media (max-width: 900px) {
      .logo-nav { flex-direction: column; align-items: flex-start; }
      nav ul {
        width: 100%;
        display: flex;
        justify-content: space-between;
        margin-top: 0.5rem;
      }
      nav ul li:not(:first-child):not(:nth-child(5)) {
        display: none;
      }
    }

    /* ‚Äî‚Äî‚Äî BODY & ORIGINAL STYLES ‚Äî‚Äî‚Äî */
    body {
      font-family: 'Segoe UI', sans-serif;
      color: #333;
      margin: 0;
      padding-top: calc(60px + 1rem);
      background:
        linear-gradient(135deg,#21235e 0%,#537895 100%),
        url('https://www.transparenttextures.com/patterns/cubes.png');
      background-blend-mode: overlay;
      background-attachment: fixed;
    }
    .spacer { height: calc(60px + 1rem); }

    .container {
      max-width: 980px;
      margin: 1.5rem auto;
      background: rgba(255,255,255,0.85);
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 6px 24px rgba(0,0,0,0.3);
      display: flex; flex-direction: column; gap: 1rem;
    }
    .info-note { font-size:1.1rem; color:#003366; font-weight:600; }
    .selected-date-time {
      display:none;
      background:#eaf3ff; border-radius:8px;
      padding:.75rem 1rem; font-weight:600; color:#0057b7;
      text-align:center; box-shadow:0 1px 6px #bedcff36;
      margin:.5rem 0 1rem;
    }
    .calendar-bg-image { position:relative; overflow:hidden; }
    .calendar-bg-image::before {
      content:""; position:absolute; inset:0; z-index:0;
      background:
        url('https://images.unsplash.com/photo-1519677100203-a0e668c92439?auto=format&fit=crop&w=900&q=80')
        center/cover no-repeat;
      filter: blur(2px) brightness(0.65);
      opacity:0.8;
    }
    #calendar { position:relative; z-index:1; background:transparent!important; }
    .fc { background:transparent!important; }
    .fc .fc-col-header-cell-cushion,
    .fc .fc-daygrid-day-number,
    .fc .fc-daygrid-event,
    .fc .fc-daygrid-event .fc-event-title {
      color:#fff!important; font-weight:700; text-shadow:0 2px 6px #000;
    }
    .fc .fc-daygrid-day:hover { background:rgba(0,87,183,0.13)!important; }
    #slot-list { display:flex; flex-wrap:wrap; gap:.5rem; }
    .slot {
      flex:1 0 30%; padding:.6rem; border-radius:6px;
      background:rgba(230,240,255,0.8); border:1px solid #0057b7;
      text-align:center; color:#003366; cursor:pointer; font-weight:500;
    }
    .slot.booked { background:#ddd; color:#666; cursor:default; }
    .slot.selected { background:#0057b7; color:#fff; }
    #booking-form { display:none; flex-direction:column; gap:.7rem; }
    label { font-weight:600; }
    input, textarea, button {
      width:100%; padding:.6rem; border-radius:6px; border:1px solid #ccc;
    }
    button {
      background:#0057b7; color:#fff; border:none; cursor:pointer; transition:background .2s;
    }
    button:hover { background:#004494; }

    #greetings-section,
    #payment-methods,
    #payment-success {
      display:none; flex-direction:column; align-items:center; gap:1rem;
    }
    /* Floating icons */
    .floating-whatsapp, .floating-facebook {
      position:fixed; width:54px; height:54px;
      border-radius:50%; background:#fff;
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 2px 10px rgba(0,0,0,0.16); z-index:9999;
    }
    .floating-whatsapp { right:18px; bottom:22px; }
    .floating-facebook { right:18px; bottom:90px; }
    .floating-whatsapp img, .floating-facebook img { width:32px; height:32px; }
    @media (max-width:600px) {
      .floating-whatsapp, .floating-facebook { width:44px; height:44px; }
      .floating-whatsapp { right:10px; bottom:22px; }
      .floating-facebook { right:10px; bottom:68px; }
      .floating-whatsapp img, .floating-facebook img { width:24px; height:24px; }
    }
  </style>
</head>
<body>

  <!-- HEADER/Nav -->
  <header>
    <div class="logo-nav">
      <img src="assets/images/logo.png" alt="VIONYX Logo" />
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="rooms.html">Function Rooms</a></li>
          <li><a href="events.html">Events</a></li>
          <li><a href="gallery.html">Gallery</a></li>
          <li><a href="contact.html">Contact Us</a></li>
          <li><a href="booking.html">Check Availability</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="spacer"></div>

  <!-- PAGE CONTENT -->
  <div class="container">
    <div class="info-note">Select a date to start booking</div>
    <div id="selected-date-time" class="selected-date-time"></div>
    <div class="calendar-card calendar-bg-image" id="calendar-wrapper">
      <div id="calendar"></div>
    </div>
    <div class="calendar-card" id="slot-list"></div>
    <form class="calendar-card" id="booking-form">
      <div id="selected-range"></div>
      <label for="name">Full Name</label>
      <input type="text" id="name" required />
      <label for="email">Email Address</label>
      <input type="email" id="email" required />
      <label for="phone">Phone Number</label>
      <input type="tel" id="phone" required />
      <label for="function">Function Details</label>
      <textarea id="function" rows="3" required></textarea>
      <label for="attendees">Number of Persons Attending</label>
      <input type="number" id="attendees" min="1" required />
      <div class="total" id="totalAmount"></div>
      <button type="submit">Submit for Approval</button>
    </form>
    <div class="calendar-card" id="greetings-section">
      <h3>üéâ Congratulations, your booking is approved!</h3>
      <p>
        Thank you for booking with Vionyx. Please proceed to payment to confirm your slot.<br>
        <span id="greetings-datetime"></span>
      </p>
      <button id="paynow-btn">Pay Now</button>
    </div>
    <div class="calendar-card" id="payment-methods">
      <h3>Choose Your Payment Method</h3>
      <button class="pay-method-btn" onclick="completePayment('Card')">üí≥ Pay by Card</button>
      <button class="pay-method-btn" onclick="completePayment('PayPal')">üåê PayPal</button>
      <button class="pay-method-btn" onclick="completePayment('Apple/Google Pay')">üì± Apple/Google Pay</button>
      <button class="pay-method-btn" onclick="completePayment('Bank Transfer')">üè¶ Bank Transfer</button>
    </div>
    <div class="calendar-card" id="payment-success">
      <h3>‚úÖ Payment Successful!</h3>
      <p>
        Thank you for your payment.<br>
        <b>Your booking has been confirmed and added to the calendar.</b><br><br>
        <span id="success-date-time"></span><br>
        <span id="receipt-message"></span>
      </p>
    </div>
  </div>

  <!-- FullCalendar & JS Logic -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const calendarEl = document.getElementById('calendar');
      const slotList = document.getElementById('slot-list');
      const bookingForm = document.getElementById('booking-form');
      const selectedRangeText = document.getElementById('selected-range');
      const totalAmountDisplay = document.getElementById('totalAmount');
      const greetingsSection = document.getElementById('greetings-section');
      const greetingsDatetime = document.getElementById('greetings-datetime');
      const paynowBtn = document.getElementById('paynow-btn');
      const paymentMethods = document.getElementById('payment-methods');
      const paymentSuccess = document.getElementById('payment-success');
      const receiptMessage = document.getElementById('receipt-message');
      const popup = document.createElement('div');
      popup.style.cssText = 'position:fixed;top:20px;left:50%;transform:translateX(-50%);background:#0057b7;color:#fff;padding:.75rem 1.5rem;border-radius:6px;font-size:1rem;opacity:0;transition:opacity .3s;z-index:9999;';
      document.body.appendChild(popup);

      let sessionBookedEvents = [];
      let startHour = null, endHour = null, currentDate = '', globalDateTimeString = '';
      let allSlotDivs = [], finalTotal = 0, sessionBookingRange = null;

      const bookedEvents = [
        { title: 'Wedding (10:00‚Äì13:00)', start: '2025-08-04T10:00:00', end: '2025-08-04T13:00:00' },
        { title: 'Birthday Party (14:00‚Äì19:00)', start: '2025-08-04T14:00:00', end: '2025-08-04T19:00:00' },
        { title: 'Anniversary Lunch (11:00‚Äì15:00)', start: '2025-08-10T11:00:00', end: '2025-08-10T15:00:00' },
        { title: 'Conference (9:00‚Äì17:00)',       start: '2025-08-13T09:00:00', end:   '2025-08-13T17:00:00' },
        { title: 'Music Festival (18:00‚Äì23:30)',  start: '2025-08-14T18:00:00', end:   '2025-08-14T23:30:00' },
        { title: 'Business Meetup (09:00‚Äì13:00)', start: '2025-08-19T09:00:00', end:   '2025-08-19T13:00:00' },
        { title: 'Engagement (12:00‚Äì18:00)',      start: '2025-08-23T12:00:00', end:   '2025-08-23T18:00:00' },
        { title: 'Baby Shower (10:00‚Äì14:00)',     start: '2025-09-03T10:00:00', end:   '2025-09-03T14:00:00' },
        { title: 'Training Session (15:00‚Äì19:00)',start: '2025-09-05T15:00:00', end:   '2025-09-05T19:00:00' }
      ];

      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        height: 'auto',
        events: bookedEvents,
        dateClick: info => selectDate(info.dateStr),
      });
      calendar.render();

      function selectDate(dateStr) {
        currentDate = dateStr;
        resetSelection();
        renderSlots(dateStr);
        showPopup(`Selected date: ${dateStr}`);
      }

      function renderSlots(dateStr) {
        slotList.innerHTML = '';
        allSlotDivs = [];
        const ranges = bookedEvents.concat(sessionBookedEvents)
          .filter(e => e.start.startsWith(dateStr))
          .map(e => ({
            min: new Date(e.start).getHours(),
            max: new Date(e.end||e.start).getHours()
          }));

        for (let h = 7; h <= 23; h++) {
          const slot = document.createElement('div');
          slot.className = 'slot';
          slot.textContent = `${h}:00`;
          slot.dataset.hour = h;
          if (ranges.some(r => h >= r.min && h <= r.max)) {
            slot.classList.add('booked');
          } else {
            slot.onclick = () => handleSlotClick(h);
          }
          allSlotDivs.push(slot);
          slotList.appendChild(slot);
        }
      }

      function handleSlotClick(hour) {
        if (startHour===null) {
          startHour=hour;
          highlightSlots(startHour,startHour);
          selectedRangeText.textContent=`Start: ${formatHour(startHour)}`;
          globalDateTimeString=`<b>Date:</b> ${currentDate}`;
          showPopup('Now select end time');
        } else if (endHour===null) {
          endHour=hour;
          const min=Math.min(startHour,endHour), max=Math.max(startHour,endHour);
          if (rangesOverlap(min,max)) {
            showPopup('Some slots in this range are booked');
            return resetSelection();
          }
          highlightSlots(min,max);
          const dur=max-min+1;
          finalTotal=dur*15;
          selectedRangeText.textContent=
            `Selected: ${formatHour(min)} to ${formatHour(max)} (${dur} hr${dur>1?'s':''})`;
          totalAmountDisplay.textContent=`Total Amount: ¬£${finalTotal}`;
          globalDateTimeString=
            `<b>Date:</b> ${currentDate}, <b>Time:</b> ${formatHour(min)} to ${formatHour(max)}`;
          bookingForm.style.display='flex';
        } else resetSelection();
      }

      function rangesOverlap(min,max) {
        return bookedEvents.concat(sessionBookedEvents)
          .filter(e=>e.start.startsWith(currentDate))
          .some(e=>{
            const s=new Date(e.start).getHours();
            const m=new Date(e.end||e.start).getHours();
            return Math.max(s,min)<=Math.min(m,max);
          });
      }

      function highlightSlots(min,max) {
        allSlotDivs.forEach(el=>{
          const h=+el.dataset.hour;
          el.classList.toggle('selected',
            h>=min&&h<=max&&!el.classList.contains('booked'));
        });
      }

      function resetSelection() {
        startHour=endHour=null; finalTotal=0;
        bookingForm.style.display='none';
        greetingsSection.style.display='none';
        paymentMethods.style.display='none';
        paymentSuccess.style.display='none';
        slotList.querySelectorAll('.slot').forEach(el=>el.classList.remove('selected'));
      }

      paynowBtn.onclick=()=>{
        greetingsSection.style.display='none';
        paymentMethods.style.display='flex';
      };

      bookingForm.onsubmit=e=>{
        e.preventDefault();
        greetingsSection.style.display='flex';
        const {min,max} = sessionBookingRange = { date:currentDate, min:startHour, max:endHour };
        const ds=new Date(currentDate); ds.setHours(min,0,0,0);
        const de=new Date(currentDate); de.setHours(max,0,0,0);
        const detail=document.getElementById('function').value.trim();
        const ev={ title:`${detail} (${formatHour(min)}‚Äì${formatHour(max)})`,
                   start:ds.toISOString().slice(0,16),
                   end:de.toISOString().slice(0,16) };
        sessionBookedEvents.push(ev);
        calendar.addEvent(ev);
      };

      window.completePayment=method=>{
        paymentMethods.style.display='none';
        paymentSuccess.style.display='flex';
        const email=document.getElementById('email').value||'';
        successDateTime.innerHTML=`<b>Booking:</b> ${globalDateTimeString}`;
        receiptMessage.innerHTML=`<b>Receipt sent to:</b><br><span style="color:#0057b7;">${email}</span>`;
        showPopup(`${method} payment successful!`);
        setTimeout(()=>location.reload(),5000);
      };

      function showPopup(msg){
        popup.textContent=msg; popup.style.opacity=1;
        setTimeout(()=>popup.style.opacity=0,2500);
      }

      function formatHour(h){
        const suf=h>=12?'PM':'AM', hr=h>12?h-12:h;
        return `${hr}:00 ${suf}`;
      }
    });
  </script>

  <!-- Floating Icons -->
  <a href="https://wa.me/447123456789" class="floating-whatsapp"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp"/></a>
  <a href="https://www.facebook.com/messages/t/yourfacebookpageid" class="floating-facebook"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook"/></a>

</body>
</html>
